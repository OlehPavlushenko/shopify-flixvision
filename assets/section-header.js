class SectionHeader extends HTMLElement{constructor(){super(),this.megaMenuWrappers=[...this.querySelectorAll(".js-mega-menu-wrapper")],this.megaSubMenuWrappers=[...this.querySelectorAll(".js-mega-submenu-wrapper")],this.megaMenus=[...this.querySelectorAll(".js-mega-menu")],this.megaSubmenus=[...this.querySelectorAll(".js-mega-submenu")],this.menuToggles=[...this.querySelectorAll(".js-menu-toggle")],this.menuBacks=[...this.querySelectorAll(".js-menu-back")],this.submenuBacks=[...this.querySelectorAll(".js-submenu-back")],this.mobileMenu=this.querySelector(".js-mobile-menu"),this.mobileMenuOverlay=this.querySelector(".js-mobile-menu-overlay"),this.init(),this.resizeFunction(),window.addEventListener("resize",this.resizeFunction.bind(this)),["click","enter"].forEach((e=>{this.megaSubMenuWrappers.forEach((s=>{s.querySelectorAll(".js-mega-submenu-next-button").forEach((s=>{s.addEventListener(e,this.showMegaMenu.bind(this))}))})),this.menuToggles.forEach((s=>{s.addEventListener(e,this.showMobileMenu.bind(this))})),this.menuBacks.forEach((s=>{s.addEventListener(e,this.closeMegaMenu.bind(this))})),this.submenuBacks.forEach((s=>{s.addEventListener(e,this.closeMegaSubMenu.bind(this))}))})),this.addEventListener("keydown",(e=>{"Escape"===e.key&&this.onKeyUp(e)}))}resizeFunction(){let e=window.matchMedia("(max-width: 990px)").matches;["click","enter"].forEach((s=>this.megaMenuWrappers.forEach((t=>{if(e){t.querySelectorAll(".js-mega-parent-next-button").forEach((e=>{e.addEventListener(s,this.showMegaMenu.bind(this))}))}else t.addEventListener(s,this.showDesktopMegaMenu.bind(this)),this.addEventListener("keydown",(e=>{"Escape"===e.key&&this.closeMegaMenu(e)}))}))))}showMobileMenu(e){e.preventDefault(),this.mobileMenu.classList.toggle("menu-opening"),this.mobileMenuOverlay.classList.toggle("menu-opening"),document.body.classList.toggle("overflow-hidden")}closeMobileMenu(){this.mobileMenu.classList.remove("menu-opening"),this.mobileMenuOverlay.classList.remove("menu-opening"),trapFocus(this),document.body.classList.remove("overflow-hidden")}showDesktopMegaMenu(e){e.preventDefault();let s=e.currentTarget.closest(".js-mega-menu-wrapper").querySelector(".js-mega-menu");this.megaMenus.forEach((e=>{s.classList.contains("mega-menu--open")||e.classList.remove("mega-menu--open")})),s.classList.toggle("mega-menu--open")}showMegaMenu(e){if(e.preventDefault(),e.target.classList.contains("js-mega-parent-next-button")){e.target.closest(".js-mega-menu-wrapper").querySelector(".js-mega-menu").classList.toggle("mega-menu--open")}else{e.target.closest(".js-mega-submenu-wrapper").querySelector(".js-mega-submenu").classList.toggle("mega-menu--open")}}closeMegaMenu(e){if(e.target.blur(),e.target.closest(".js-mega-menu-wrapper")){let s=e.target.closest(".js-mega-menu-wrapper"),t=e.target.closest(".header__menu-item-details").querySelector(".header__menu-item-link");trapFocus(s,t)}this.megaMenus.forEach((e=>{e.classList.remove("mega-menu--open")}))}closeMegaSubMenu(e){if(e.target.closest(".js-mega-submenu-wrapper")){let s=e.target.closest(".js-mega-submenu-wrapper"),t=e.target.closest(".js-mega-submenu-wrapper").querySelector(".js-mega-menu-title");trapFocus(s,t)}this.megaSubmenus.forEach((e=>{e.classList.remove("mega-menu--open")}))}onKeyUp(e){(e.target.classList.contains("js-menu-toggle")||e.target.classList.contains("header__menu-item-link"))&&this.closeMobileMenu(),(e.target.classList.contains("js-mega-parent-next-button")||e.target.classList.contains("js-mega-menu-title")||e.target.classList.contains("js-submenu-back")||e.target.classList.contains("mega-menu__list-column-title"))&&this.closeMegaMenu(e),(e.target.classList.contains("js-mega-submenu-next-button")||e.target.classList.contains("mega-menu__list")||e.target.classList.contains("js-mega-submenu-row")||e.target.classList.contains("mega-menu__list-item-link"))&&this.closeMegaSubMenu(e)}show(){this.classList.add("show")}reset(){this.classList.remove("show")}onScroll(){const e=window.pageYOffset||document.documentElement.scrollTop;e>this.currentScrollTop&&e>this.headerBounds.top?this.show():e<=this.headerBounds.top&&this.reset(),this.currentScrollTop=e}createObserver(){new IntersectionObserver(((e,s)=>{this.headerBounds=e[0].intersectionRect,s.disconnect()})).observe(this)}init(){this.onScrollHandler=this.onScroll.bind(this),this.headerBounds={},this.currentScrollTop=0,window.addEventListener("scroll",this.onScrollHandler,!1),this.createObserver()}}customElements.define("sticky-header",SectionHeader);