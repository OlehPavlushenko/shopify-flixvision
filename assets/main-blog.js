class BlogSelect extends HTMLElement{constructor(){super(),this.select=this,this.layout=this.dataset.layout,this.selectTitle=this.select.querySelector(".js-title"),this.selectField=this.select.querySelector(".js-box"),this.selectList=this.querySelectorAll(".js-list"),this.selectBtn=this.querySelector(".js-btn"),this.selectUrl=this.selectBtn.href,document.addEventListener("click",this.closeAnyway.bind(this)),this.selectTitle.addEventListener("click",this.onClick.bind(this)),this.selectTitle.addEventListener("keypress",this.keyClick.bind(this)),this.selectField.addEventListener("keydown",this.handleKeyDown.bind(this)),this.activeIndex=-1,this.length=this.selectList.length,this.layout?this.sortList():this.filterList()}closeAnyway(e){e.target.closest("custom-select")||(this.close(),this.selectList.forEach((e=>{e.classList.contains("hover")&&e.classList.remove("hover")})))}handleKeyDown(e){const{key:t}=e;"ArrowDown"===t&&this.moveDown(e),"ArrowUp"===t&&this.moveUp(e),"Enter"!==t&&"Space"!==e.code||this.pushSelect(e)}moveDown(e){e.preventDefault(),this.activeIndex=(this.activeIndex+1)%this.length,this.navigateThroughElement(this.activeIndex)}moveUp(e){e.preventDefault(),-1===this.activeIndex&&(this.activeIndex=0),this.activeIndex=(this.length+(this.activeIndex-1))%this.length,this.navigateThroughElement(this.activeIndex)}navigateThroughElement(e,t){this.selectList.forEach((e=>{e.classList.contains("hover")&&e.classList.remove("hover")})),this.selectList[e].classList.add("hover")}pushSelect(e){e.preventDefault();let t=this.selectList[this.activeIndex];void 0!==t&&(this.layout?this.stateSelectSort(t):this.stateSelectFilter(t))}onClick(e){e.preventDefault(),this.select.classList.contains("open")?this.close():this.open()}keyClick(e){"Enter"===e.key&&(e.preventDefault(),this.select.classList.contains("open")?this.close():this.open())}close(){this.select.classList.remove("open"),this.selectField.setAttribute("tabindex","-1")}open(){document.querySelectorAll("custom-select").forEach((e=>{e.classList.contains("open")&&e.classList.remove("open")})),this.selectList.forEach((e=>{e.classList.contains("hover")&&e.classList.remove("hover")})),this.select.classList.add("open"),this.selectField.setAttribute("tabindex","0")}sortList(){this.selectList.forEach((e=>{e.addEventListener("click",this.stateSelectSort.bind(this,e))}))}stateSelectSort(e){this.selectList.forEach((e=>{e.classList.remove("active")})),e.classList.contains("active")||(e.classList.add("active"),e.classList.contains(this.layout)?this.selectBtn.classList.remove("disabled"):this.selectBtn.classList.add("disabled"))}filterList(){this.selectList.forEach((e=>{e.addEventListener("click",this.stateSelectFilter.bind(this,e))}))}stateSelectFilter(e){let t,s,i=window.location.href;e.classList.contains("active")?(e.classList.remove("active"),s=i.includes("?blog=oldest")?this.selectUrl+"?blog=oldest":this.selectUrl):(this.selectList.forEach((e=>{e.classList.remove("active")})),e.classList.add("active"),t=e.dataset.filter,s=i.includes("?blog=oldest")?this.selectUrl+"/tagged/"+t+"?blog=oldest":this.selectUrl+"/tagged/"+t),this.selectBtn.href=s;try{this.selectList.forEach((e=>{if(e.classList.contains("active"))throw this.selectBtn.classList.remove("disabled"),"Break";i.includes("tagged")?this.selectBtn.classList.remove("disabled"):this.selectBtn.classList.add("disabled")}))}catch(e){if("Break"!==e)throw e}}}customElements.define("custom-select",BlogSelect);class BlogLoadMore extends HTMLElement{constructor(){super(),window.currentPage=1,this.addEventListener("click",this.loadNextPage.bind(this))}getQueryForBlogPagination(e){const t=new URLSearchParams(window.location.search);let s="";for(let e of t)"page"!==e[0]&&(""!==s&&(s+="&"),s+=`${e[0]}=${e[1]}`);return`?section_id=${e}&page=${window.currentPage}${""!==s?"&":""}`+s}loadNextPage(){const e=document.getElementById("main-blog-post-grid").dataset.id;window.currentPage++;const t=this.getQueryForBlogPagination(e);fetch(t).then((e=>e.text())).then((t=>{const s=(new DOMParser).parseFromString(t,"text/html").querySelector(`[id*="${e}"]`).innerHTML;this.renderPostGrid(s)}))}renderPostGrid(e){const t=(new DOMParser).parseFromString(e,"text/html"),s=t.getElementById("main-blog-post-grid"),i=s.innerHTML,l=parseInt(t.querySelector(".js-post-count").innerHTML),c=parseInt(t.querySelector(".js-total-post-count").innerHTML);document.querySelector(".js-post-count").innerHTML=l>=c?c:l,s.querySelector(".article")&&document.getElementById("main-blog-post-grid").insertAdjacentHTML("beforeend",i),l>=c&&(document.querySelector(".js-blog-load-more").style.display="none");const o=new URLSearchParams(window.location.search).toString();history.pushState({searchParams:o},"",`${window.location.pathname}${o&&"?".concat(o)}`)}}customElements.define("blog-load-more",BlogLoadMore);